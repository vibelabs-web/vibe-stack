# User Flow: 바이브랩스 커뮤니티

핵심 기능별 사용자 여정을 정의합니다.

## 1. 인증 플로우

### 1.1 회원가입

```mermaid
graph TD
    A[회원가입 페이지] --> B[이메일 입력]
    B --> C{이메일 형식 검증}
    C -- 실패 --> D[에러 표시: 올바른 이메일 형식이 아니에요]
    C -- 성공 --> E{이메일 중복 체크}
    E -- 중복 --> F[에러 표시: 이미 사용 중인 이메일이에요]
    E -- 사용가능 --> G[비밀번호 입력]
    G --> H{비밀번호 규칙 검증}
    H -- 실패 --> I[에러 표시: 8자 이상, 영문+숫자 조합이 필요해요]
    H -- 성공 --> J[비밀번호 확인 입력]
    J --> K{비밀번호 일치 확인}
    K -- 불일치 --> L[에러 표시: 비밀번호가 일치하지 않아요]
    K -- 일치 --> M[닉네임 입력]
    M --> N{닉네임 규칙 검증}
    N -- 실패 --> O[에러 표시: 2-20자 사이로 입력해주세요]
    N -- 성공 --> P{닉네임 중복 체크}
    P -- 중복 --> Q[에러 표시: 이미 사용 중인 닉네임이에요]
    P -- 사용가능 --> R[가입 완료 버튼 클릭]
    R --> S[자동 로그인]
    S --> T[메인 페이지로 이동]
    T --> U[환영 메시지 표시]
```

### 1.2 로그인

```mermaid
graph TD
    A[로그인 페이지] --> B[이메일/비밀번호 입력]
    B --> C[로그인 버튼 클릭]
    C --> D{인증 검증}
    D -- 실패 --> E[에러 표시: 이메일 또는 비밀번호가 맞지 않아요]
    D -- 성공 --> F[JWT 토큰 발급]
    F --> G[토큰 저장]
    G --> H{이전 페이지 있음?}
    H -- Yes --> I[이전 페이지로 이동]
    H -- No --> J[메인 페이지로 이동]
```

### 1.3 로그아웃

```mermaid
graph TD
    A[헤더의 로그아웃 버튼] --> B[로그아웃 확인 모달]
    B -- 취소 --> C[모달 닫기]
    B -- 확인 --> D[토큰 삭제]
    D --> E[상태 초기화]
    E --> F[메인 페이지로 이동]
    F --> G[로그아웃 완료 토스트]
```

## 2. 프로필 플로우

### 2.1 프로필 조회

```mermaid
graph TD
    A[프로필 페이지 접근] --> B{본인 프로필?}
    B -- Yes --> C[전체 정보 표시 + 수정 버튼]
    B -- No --> D[공개 정보만 표시]

    C --> E[닉네임, 자기소개, 프로필 이미지]
    C --> F[가입일, 작성 글 수, 받은 좋아요 수]
    C --> G[내가 쓴 글 탭]
    C --> H[내가 좋아요한 글 탭]

    D --> I[닉네임, 자기소개, 프로필 이미지]
    D --> J[작성 글 수, 받은 좋아요 수]
    D --> K[작성한 글 목록]
```

### 2.2 프로필 수정

```mermaid
graph TD
    A[프로필 수정 버튼] --> B[수정 모달/페이지]
    B --> C[닉네임 변경]
    C --> D{닉네임 중복 체크}
    D -- 중복 --> E[에러 표시]
    D -- 사용가능 --> F[자기소개 변경]
    F --> G[프로필 이미지 URL 변경]
    G --> H[저장 버튼]
    H --> I{유효성 검증}
    I -- 실패 --> J[에러 표시]
    I -- 성공 --> K[프로필 업데이트]
    K --> L[성공 토스트]
```

### 2.3 비밀번호 변경

```mermaid
graph TD
    A[비밀번호 변경 버튼] --> B[비밀번호 변경 모달]
    B --> C[현재 비밀번호 입력]
    C --> D[새 비밀번호 입력]
    D --> E[새 비밀번호 확인]
    E --> F[변경 버튼]
    F --> G{현재 비밀번호 확인}
    G -- 불일치 --> H[에러: 현재 비밀번호가 맞지 않아요]
    G -- 일치 --> I{새 비밀번호 검증}
    I -- 실패 --> J[에러: 비밀번호 규칙 안내]
    I -- 성공 --> K[비밀번호 변경 완료]
    K --> L[성공 토스트]
```

## 3. 게시판 플로우

### 3.1 글 목록 조회

```mermaid
graph TD
    A[메인 페이지] --> B[게시글 목록 로드]
    B --> C{정렬 기준}
    C -- 최신순 --> D[created_at DESC]
    C -- 인기순 --> E[likes_count DESC]

    D --> F[게시글 카드 표시]
    E --> F

    F --> G[제목, 작성자, 좋아요 수, 댓글 수]
    F --> H[작성 시간]
    F --> I[미리보기 내용]

    G --> J{더 보기}
    J -- 클릭 --> K[다음 페이지 로드]
    J -- 스크롤 --> L[무한 스크롤로 로드]
```

### 3.2 글 작성

```mermaid
graph TD
    A[글쓰기 버튼] --> B{로그인 상태?}
    B -- No --> C[로그인 페이지로 이동]
    B -- Yes --> D[글쓰기 페이지]

    D --> E[제목 입력]
    E --> F[본문 작성 - 마크다운 지원]
    F --> G[미리보기 확인]
    G --> H{저장?}
    H -- 임시저장 --> I[localStorage에 저장]
    H -- 게시 --> J{유효성 검증}
    J -- 실패 --> K[에러 표시: 제목과 내용을 입력해주세요]
    J -- 성공 --> L[게시글 생성 API 호출]
    L --> M[상세 페이지로 이동]
    M --> N[게시 완료 토스트]
```

### 3.3 글 상세 조회

```mermaid
graph TD
    A[게시글 클릭] --> B[상세 페이지 이동]
    B --> C[조회수 증가]
    C --> D[게시글 내용 렌더링]
    D --> E[코드 블록 하이라이팅]

    E --> F{본인 글?}
    F -- Yes --> G[수정/삭제 버튼 표시]
    F -- No --> H[좋아요 버튼만 표시]

    E --> I[댓글 목록 로드]
    I --> J[댓글 표시]
    J --> K[대댓글 표시]
```

### 3.4 글 수정

```mermaid
graph TD
    A[수정 버튼] --> B{본인 글 확인}
    B -- No --> C[권한 없음 에러]
    B -- Yes --> D[수정 페이지로 이동]
    D --> E[기존 내용 로드]
    E --> F[내용 수정]
    F --> G[수정 완료 버튼]
    G --> H{유효성 검증}
    H -- 실패 --> I[에러 표시]
    H -- 성공 --> J[게시글 수정 API 호출]
    J --> K[상세 페이지로 이동]
    K --> L[수정 완료 토스트]
```

### 3.5 글 삭제

```mermaid
graph TD
    A[삭제 버튼] --> B[삭제 확인 모달]
    B -- 취소 --> C[모달 닫기]
    B -- 확인 --> D{본인 글 확인}
    D -- No --> E[권한 없음 에러]
    D -- Yes --> F[게시글 삭제 API 호출]
    F --> G[목록 페이지로 이동]
    G --> H[삭제 완료 토스트]
```

## 4. 댓글/대댓글 플로우

### 4.1 댓글 작성

```mermaid
graph TD
    A[댓글 입력창] --> B{로그인 상태?}
    B -- No --> C[로그인 유도 메시지]
    B -- Yes --> D[댓글 내용 입력]
    D --> E[등록 버튼]
    E --> F{유효성 검증}
    F -- 실패 --> G[에러: 500자 이내로 작성해주세요]
    F -- 성공 --> H[댓글 생성 API 호출]
    H --> I[댓글 목록 새로고침]
    I --> J[입력창 초기화]
```

### 4.2 대댓글 작성

```mermaid
graph TD
    A[답글 버튼 클릭] --> B{로그인 상태?}
    B -- No --> C[로그인 페이지로 이동]
    B -- Yes --> D[대댓글 입력창 표시]
    D --> E[대댓글 내용 입력]
    E --> F[등록 버튼]
    F --> G{유효성 검증}
    G -- 실패 --> H[에러 표시]
    G -- 성공 --> I[대댓글 생성 API 호출]
    I --> J[대댓글 목록 새로고침]
```

### 4.3 댓글 수정/삭제

```mermaid
graph TD
    A[댓글 메뉴 버튼] --> B{본인 댓글?}
    B -- No --> C[메뉴 숨김]
    B -- Yes --> D[수정/삭제 메뉴 표시]

    D -- 수정 --> E[인라인 수정 모드]
    E --> F[내용 수정]
    F --> G[수정 완료]
    G --> H[댓글 수정 API 호출]

    D -- 삭제 --> I[삭제 확인 모달]
    I -- 취소 --> J[모달 닫기]
    I -- 확인 --> K[댓글 삭제 API 호출]
    K --> L[댓글 목록 새로고침]
```

## 5. 좋아요 플로우

```mermaid
graph TD
    A[좋아요 버튼 클릭] --> B{로그인 상태?}
    B -- No --> C[로그인 페이지로 이동]
    B -- Yes --> D{이미 좋아요?}
    D -- Yes --> E[좋아요 취소 API 호출]
    E --> F[하트 비활성화]
    F --> G[좋아요 수 -1]
    D -- No --> H[좋아요 추가 API 호출]
    H --> I[하트 활성화 + 애니메이션]
    I --> J[좋아요 수 +1]
```

## 6. 랭킹 플로우

```mermaid
graph TD
    A[랭킹 페이지] --> B{기간 선택}
    B -- 일간 --> C[오늘 좋아요 기준]
    B -- 주간 --> D[이번 주 좋아요 기준]
    B -- 전체 --> E[전체 기간 좋아요 기준]

    C --> F[랭킹 API 호출]
    D --> F
    E --> F

    F --> G[인기 게시글 탭]
    F --> H[인기 사용자 탭]

    G --> I[순위, 제목, 작성자, 좋아요 수]
    H --> J[순위, 닉네임, 받은 좋아요 수, 게시글 수]
```

## 7. 주요 화면 설명

### 7.1 헤더 (Header)
| 상태 | 표시 요소 |
|------|-----------|
| 비로그인 | 로고, 로그인 버튼, 회원가입 버튼 |
| 로그인 | 로고, 글쓰기 버튼, 알림 아이콘, 프로필 드롭다운 |

### 7.2 메인/목록 페이지
- "오늘의 열정"을 한눈에 볼 수 있는 활기찬 카드 레이아웃
- 정렬 옵션: 최신순 / 인기순
- 무한 스크롤 또는 페이지네이션

### 7.3 글쓰기 페이지
- 방해 요소 없는 몰입형 에디터
- 마크다운 미리보기 지원
- 다정한 가이드 메시지 (placeholder)

### 7.4 상세 페이지
- 코드 블록이 예쁘게 렌더링
- 하단에 '응원 릴레이(댓글)'가 이어지는 구조
- 대댓글 1단계 들여쓰기 표시

### 7.5 랭킹 페이지
- "이주의 열정 왕" 캐릭터가 배지를 달고 나타남
- 탭으로 게시글/사용자 랭킹 전환
- 기간 필터 (일간/주간/전체)

### 7.6 프로필 페이지
- 프로필 카드 (이미지, 닉네임, 자기소개)
- 통계 (작성 글 수, 받은 좋아요 수)
- 탭: 내가 쓴 글 / 좋아요한 글

## 8. 에러 처리 가이드라인

| 상황 | 메시지 예시 |
|------|-------------|
| 네트워크 오류 | "연결이 불안정해요. 잠시 후 다시 시도해주세요." |
| 권한 없음 | "이 작업을 수행할 권한이 없어요." |
| 존재하지 않는 페이지 | "앗, 찾으시는 페이지가 없어요. 다른 곳을 둘러보시겠어요?" |
| 세션 만료 | "다시 로그인해주세요." |
| 서버 오류 | "잠시 문제가 생겼어요. 곧 해결할게요!" |
